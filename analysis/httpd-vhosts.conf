<VirtualHost *:80>
        ServerName www.floehopper.org
        DocumentRoot /var/www/www.floehopper.org
        RewriteEngine On
        RewriteCond %{HTTP_HOST}   !^blog\.floehopper\.org [NC]
        RewriteCond %{HTTP_HOST}   !^$
        RewriteRule ^/(.*)         http://blog.floehopper.org/$1 [R=301,L]
</VirtualHost>

<VirtualHost *:80>

        ServerName blog.floehopper.org
        DocumentRoot /home/floehopper/projects/floehopper/public
        <Directory "/home/floehopper/projects/floehopper/public">
          Options FollowSymLinks
          AllowOverride None
          Order allow,deny
          Allow from all
        </Directory>

        ###########################################
        # PASSENGER
        ###########################################
        RailsEnv production

        ###########################################
        # REDIRECTS
        ###########################################
        RewriteEngine On
        RewriteRule ^/xml/atom/feed.xml http://feeds.floehopper.org/floehopper-blog [R=301,L]
        RewriteRule ^/xml/atom10/feed.xml http://feeds.floehopper.org/floehopper-blog [R=301,L]
        RewriteRule ^/xml/rss/feed.xml http://feeds.floehopper.org/floehopper-blog [R=301,L]
        RewriteRule ^/xml/rss20/feed.xml http://feeds.floehopper.org/floehopper-blog [R=301,L]

        ###########################################
        # MONGREL INTEGRATION
        #
        # cd ~/projects/floehopper
        # mongrel_rails start -p 8000 -e production -d
        ###########################################
        
        # ProxyRequests Off
        # ProxyPass / http://localhost:8000/
        # ProxyPassReverse / http://localhost:8000/
        # ProxyPreserveHost On

        ###########################################
        # COMPRESSION
        ###########################################
        
        # Insert filter
        SetOutputFilter DEFLATE
      
        # Netscape 4.x has some problems...
        BrowserMatch ^Mozilla/4 gzip-only-text/html
      
        # Netscape 4.06-4.08 have some more problems
        BrowserMatch ^Mozilla/4\.0[678] no-gzip
      
        # MSIE masquerades as Netscape, but it is fine
        BrowserMatch \bMSIE !no-gzip !gzip-only-text/html
      
        # Don't compress images
        SetEnvIfNoCase Request_URI \
        \.(?:gif|jpe?g|png)$ no-gzip dont-vary
      
        # Don't compress PDFs
        SetEnvIfNoCase Request_URI \
        \.pdf$ no-gzip dont-vary
        
        ###########################################
        # EXPIRES
        ###########################################
        
        # Ref: http://httpd.apache.org/docs/2.2/mod/mod_expires.html
        # Ref: http://api.rubyonrails.org/classes/ActionView/Helpers/AssetTagHelper.html
        
        ExpiresActive On
        <FilesMatch "\.(ico|gif|jpe?g|png|js|css)$">
          ExpiresDefault "access plus 1 week"
        </FilesMatch>

        ###########################################
        # LOGGING
        ###########################################

        CustomLog /var/log/apache2/blog.floehopper.org-access_log common

</VirtualHost>