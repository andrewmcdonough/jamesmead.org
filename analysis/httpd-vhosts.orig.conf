#
# Virtual Hosts
#
# If you want to maintain multiple domains/hostnames on your
# machine you can setup VirtualHost containers for them. Most configurations
# use only name-based virtual hosts so the server doesn't need to worry about
# IP addresses. This is indicated by the asterisks in the directives below.
#
# Please see the documentation at 
# <URL:http://httpd.apache.org/docs/2.2/vhosts/>
# for further details before you try to setup virtual hosts.
#
# You may use the command line option '-S' to verify your virtual host
# configuration.

#
# Use name-based virtual hosting.
#
NameVirtualHost *:80

#
# VirtualHost example:
# Almost any Apache directive may go into a VirtualHost container.
# The first VirtualHost section is used for all requests that do not
# match a ServerName or ServerAlias in any <VirtualHost> block.
#
#<VirtualHost *:80>
#    ServerAdmin webmaster@dummy-host.example.com
#    DocumentRoot /www/docs/dummy-host.example.com
#    ServerName dummy-host.example.com
#    ServerAlias www.dummy-host.example.com
#    ErrorLog /var/log/apache2/dummy-host.example.com-error_log
#    CustomLog /var/log/apache2/dummy-host.example.com-access_log common
#</VirtualHost>
#
#<VirtualHost *:80>
#    ServerAdmin webmaster@dummy-host2.example.com
#    DocumentRoot /www/docs/dummy-host2.example.com
#    ServerName dummy-host2.example.com
#    ErrorLog /var/log/apache2/dummy-host2.example.com-error_log
#    CustomLog /var/log/apache2/dummy-host2.example.com-access_log common
#</VirtualHost>

<VirtualHost *:80>
        ServerName floehopper.co.uk
        DocumentRoot /var/www/floehopper.co.uk
        RewriteEngine On
	RewriteCond %{HTTP_HOST}   !^floehopper\.com [NC]
	RewriteCond %{HTTP_HOST}   !^$
	RewriteRule ^/(.*)         http://floehopper.com/$1 [R=301,L]
</VirtualHost>
<VirtualHost *:80>
        ServerName floehopper.com
        DocumentRoot /var/www/floehopper.com
</VirtualHost>
<VirtualHost *:80>
        ServerName floehopper.org
        DocumentRoot /var/www/floehopper.org
        RewriteEngine On
	RewriteCond %{HTTP_HOST}   !^blog\.floehopper\.org [NC]
	RewriteCond %{HTTP_HOST}   !^$
	RewriteRule ^/(.*)         http://blog.floehopper.org/$1 [R=301,L]
</VirtualHost>
<VirtualHost *:80>
        ServerName www.floehopper.org
        DocumentRoot /var/www/www.floehopper.org
        RewriteEngine On
	RewriteCond %{HTTP_HOST}   !^blog\.floehopper\.org [NC]
	RewriteCond %{HTTP_HOST}   !^$
	RewriteRule ^/(.*)         http://blog.floehopper.org/$1 [R=301,L]
</VirtualHost>

<VirtualHost *:80>

        ServerName blog.floehopper.org
        DocumentRoot /home/floehopper/projects/floehopper/public
        <Directory "/home/floehopper/projects/floehopper/public">
          Options FollowSymLinks
          AllowOverride None
          Order allow,deny
          Allow from all
        </Directory>

        ###########################################
        # PASSENGER
        ###########################################
        RailsEnv production

        ###########################################
        # REDIRECTS
        ###########################################
        RewriteEngine On
        RewriteRule ^/xml/atom/feed.xml http://feeds.floehopper.org/floehopper-blog [R=301,L]
        RewriteRule ^/xml/atom10/feed.xml http://feeds.floehopper.org/floehopper-blog [R=301,L]
        RewriteRule ^/xml/rss/feed.xml http://feeds.floehopper.org/floehopper-blog [R=301,L]
        RewriteRule ^/xml/rss20/feed.xml http://feeds.floehopper.org/floehopper-blog [R=301,L]

        ###########################################
        # MONGREL INTEGRATION
        #
        # cd ~/projects/floehopper
        # mongrel_rails start -p 8000 -e production -d
        ###########################################
        
        # ProxyRequests Off
        # ProxyPass / http://localhost:8000/
        # ProxyPassReverse / http://localhost:8000/
        # ProxyPreserveHost On

        ###########################################
        # COMPRESSION
        ###########################################
        
        # Insert filter
        SetOutputFilter DEFLATE
      
        # Netscape 4.x has some problems...
        BrowserMatch ^Mozilla/4 gzip-only-text/html
      
        # Netscape 4.06-4.08 have some more problems
        BrowserMatch ^Mozilla/4\.0[678] no-gzip
      
        # MSIE masquerades as Netscape, but it is fine
        BrowserMatch \bMSIE !no-gzip !gzip-only-text/html
      
        # Don't compress images
        SetEnvIfNoCase Request_URI \
        \.(?:gif|jpe?g|png)$ no-gzip dont-vary
      
        # Don't compress PDFs
        SetEnvIfNoCase Request_URI \
        \.pdf$ no-gzip dont-vary
        
        ###########################################
        # EXPIRES
        ###########################################
        
        # Ref: http://httpd.apache.org/docs/2.2/mod/mod_expires.html
        # Ref: http://api.rubyonrails.org/classes/ActionView/Helpers/AssetTagHelper.html
        
        ExpiresActive On
        <FilesMatch "\.(ico|gif|jpe?g|png|js|css)$">
          ExpiresDefault "access plus 1 week"
        </FilesMatch>

        ###########################################
        # LOGGING
        ###########################################

        CustomLog /var/log/apache2/blog.floehopper.org-access_log common

</VirtualHost>

<VirtualHost *:80>
        ServerName cruise.floehopper.org
        DocumentRoot /var/www/cruise.floehopper.org
        ProxyRequests Off
        ProxyPass / http://localhost:8001/
        ProxyPassReverse / http://localhost:8001/
        ProxyPreserveHost On
</VirtualHost>
<VirtualHost *:80>
        ServerName hannahsmithson.org
        DocumentRoot /var/www/www.hannahsmithson.org
</VirtualHost>
<VirtualHost *:80>
        ServerName www.hannahsmithson.org
        DocumentRoot /var/www/www.hannahsmithson.org
</VirtualHost>
<VirtualHost *:80>
        ServerName sparkymagic.com
        DocumentRoot /var/www/www.sparkymagic.com
</VirtualHost>
<VirtualHost *:80>
        ServerName www.sparkymagic.com
        DocumentRoot /var/www/www.sparkymagic.com
</VirtualHost>
<VirtualHost *:80>

        ServerName installd.com
        DocumentRoot /home/floehopper/projects/installd/webapp/public
        <Directory "/home/floehopper/projects/installd/webapp/public">
          Options FollowSymLinks
          AllowOverride None
          Order allow,deny
          Allow from all
        </Directory>

        ###########################################
        # PASSENGER
        ###########################################
        RailsEnv production

</VirtualHost>
